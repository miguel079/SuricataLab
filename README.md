<h1>Examining Alerts, Logs, and Rules with Suricata IDS</h1>

<h2>Description</h2>
In this lab we're going to walk through how to examine a rule and practice using Suricata to trigger alerts on network traffic. This lab also covers analyzing log outputs, such as a fast.log and eve.json file.
<br/>


<h2>Languages and Utilities Used</h2>

- <b>Linux</b> 
- <b>Suricata IDS</b>

<h2>Environments Used </h2>

- <b>Google Qwiklabs</b> 

<h2>Program walk-through:</h2>

<p align="center">
  
<h2>First We Examine a Custom Rule in Suricata:</h2>
<p align="center">
  
Using the cat command to display the rule in the custom.rules file in the home directory:  <br/>
<img src="https://i.imgur.com/mxzVn1F.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br/>
Upon further examination of the signature, which contains an action ("alert"); a header ("http $HOME_NET any -> $EXTERNAL_NET any");
and rules options (msg:"GET on wire"; flow:established,to_server; content:"GET"; http_method; sid:12345; rev:3;) 
we see that the signature triggers an alert whenever Suricata observes the text GET as the HTTP method in an HTTP 
packet from the home network going to the external network.
<br />
<br />

<p align="center">
  
<h2>Next, We Trigger a custom rule in Suricata:</h2>
<p align="center">

Running suricata using the custom.rules and sample.pcap files in /var/log/suricata: <br/>
<img src="https://i.imgur.com/xcol5HV.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />

Listing the files in the /var/log/suricata folder to see new files created in /var/log/suricata directory: <br/>
<img src="https://i.imgur.com/rJd0VzD.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />

Using the cat command to display the fast.log file generated by Suricata: <br/>
<img src="https://i.imgur.com/XDhnxSj.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</br>
Each line or entry in the fast.log file corresponds to an alert generated by Suricata when it processes a packet that meets the conditions of an alert generating rule. 
Each alert line includes the message that identifies the rule that triggered the alert, as well as the source, destination, and direction of the traffic.
<br />
<br />

<p align="center">
  
<h2>Finally, We Examine eve.json Output:</h2>
<p align="center">

Using the cat command to display the entries in the eve.json file then use the jq command to display the entries in a better format: <br/>
<img src="https://i.imgur.com/Di1AjTh.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://i.imgur.com/t2B6Erv.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />

Using the jq command to extract specific event data from the eve.json file: <br/>
<img src="https://i.imgur.com/YI26eGp.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
The jq command above extracts the fields specified in the list in the square brackets from the JSON payload. The fields selected are the timestamp (.timestamp), the flow id (.flow_id), the alert signature or msg (.alert.signature), the protocol (.proto), and the destination IP address (.dest_ip).

<br />
<br />

Using the jq command to display all event logs related to a specific flow_id from the eve.json file. The flow_id value is a 16-digit number and will vary for each of the log entries. Here we examine the event log with flow_id 1560140769826036:<br/>
<img src="https://i.imgur.com/trlS9A3.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
Suricata assigns a unique flow_id to each network flow. All logs from a network flow share the same flow_id. This makes the flow_id field a useful field for correlating network traffic that belongs to the same network flows.
<br />
<br />

</p>

<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
